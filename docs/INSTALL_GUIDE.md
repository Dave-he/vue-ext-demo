# 浏览器扩展安装指南

## 🔧 安装步骤

### Chrome 浏览器安装

1. **构建扩展**
   ```bash
   pnpm build
   ```

2. **打开扩展管理页面**
   - 在 Chrome 地址栏输入：`chrome://extensions/`
   - 或者：菜单 → 更多工具 → 扩展程序

3. **开启开发者模式**
   - 点击右上角的"开发者模式"开关

4. **加载扩展**
   - 点击"加载已解压的扩展程序"
   - 选择项目根目录下的 `dist` 文件夹
   - 点击"选择文件夹"

5. **验证安装**
   - 扩展应该出现在扩展列表中
   - 右上角工具栏会出现扩展图标
   - 点击图标可以打开弹窗界面

### Firefox 浏览器安装

1. **构建扩展**
   ```bash
   pnpm build
   ```

2. **打开调试页面**
   - 在地址栏输入：`about:debugging#/runtime/this-firefox`

3. **加载临时扩展**
   - 点击"临时载入附加组件"
   - 选择 `dist/manifest.json` 文件
   - 点击"打开"

4. **验证安装**
   - 扩展会出现在"临时开发附加组件"列表中
   - 工具栏会出现扩展图标

## 🎯 测试功能

### 1. 扩展状态切换
- 点击扩展图标打开弹窗
- 查看扩展状态（启用/禁用）
- 点击"Disable/Enable"按钮切换状态

### 2. 文本选择功能
- 在任意网页上选择一些文本
- 在扩展弹窗中点击"Get Selection"按钮
- 查看选中的文本内容

### 3. 数据保存功能
- 点击"Save Data"按钮
- 数据会保存到 Chrome 存储中
- 在弹窗中查看保存的数据

## 🐛 故障排除

### 常见错误及解决方案

#### 错误：无法加载背景脚本
**原因**：manifest.json 中的 background.js 路径错误
**解决**：确保 manifest.json 中的路径为 `"service_worker": "assets/js/background.js"`

#### 错误：无法加载清单
**原因**：manifest.json 文件损坏或格式错误
**解决**：
1. 检查 JSON 语法是否正确
2. 确保所有必需字段存在
3. 重新运行 `pnpm build`

#### 错误：扩展无法加载
**原因**：构建文件缺失或路径错误
**解决**：
1. 确保 `dist/` 目录包含所有必需文件
2. 检查文件权限
3. 重新构建项目

### 调试方法

#### Chrome 开发者工具
1. **弹窗调试**：
   - 右键点击扩展图标
   - 选择"检查弹窗"
   - 查看控制台输出

2. **背景脚本调试**：
   - 打开扩展管理页面
   - 找到你的扩展
   - 点击"背景页"链接
   - 查看控制台输出

3. **内容脚本调试**：
   - 打开任意网页
   - 按 F12 打开开发者工具
   - 在控制台中查看扩展输出

#### 日志检查
```javascript
// 在 background.ts 中添加
console.log('Background script loaded')

// 在 content.ts 中添加
console.log('Content script loaded')

// 在 App.vue 中添加
console.log('Vue app mounted')
```

## 🔍 验证清单

安装完成后，请验证以下项目：

- [ ] 扩展出现在浏览器扩展列表中
- [ ] 扩展图标出现在工具栏
- [ ] 点击图标可以打开弹窗
- [ ] 弹窗显示正确的扩展信息
- [ ] 状态切换功能正常工作
- [ ] 文本选择功能正常工作
- [ ] 数据保存功能正常工作
- [ ] 控制台无错误信息

## 🚀 开发模式

### 热重载开发
1. 运行开发服务器：
   ```bash
   pnpm dev
   ```

2. 在 Chrome 中：
   - 打开扩展管理页面
   - 点击扩展的"重新加载"按钮
   - 修改代码后自动重新加载

### 重新加载扩展
- 在扩展管理页面点击"重新加载"按钮
- 或者右键点击扩展图标选择"重新加载"

## 📝 注意事项

1. **开发模式**：安装时必须开启开发者模式
2. **文件完整性**：确保 `dist/` 目录包含所有构建文件
3. **路径正确性**：manifest.json 中的路径必须与实际文件路径匹配
4. **权限设置**：扩展需要 `storage` 和 `activeTab` 权限
5. **Manifest V3**：项目使用 Manifest V3，需要现代浏览器支持

## 🆘 获取帮助

如果遇到问题：
1. 检查控制台错误信息
2. 确认构建是否成功
3. 验证 manifest.json 格式
4. 检查文件路径是否正确
5. 重新构建和安装扩展